"0","HRs <- cbind(hrS  = c(1, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7),"
"0","             hrSc = c(1, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2))"
"0","results <- matrix(NA, nrow = 7, ncol = 8)"
"0","colnames(results) <- c(""Reject.SF"", ""Reject.S"", ""Reject.F"", ""Primary.SF"", "
"0","                       ""Primary.S"", ""Primary.F"", ""samplesize"", ""Futile.Sc"")"
"0","designs <- c(rep(""AED"", 2), rep(""GSD"", 3), rep(""AED2"", 2))"
"0","multiplicity <- c(c(""dunnett"", ""simes""), ""ht"", c(""dunnett"", ""simes""), c(""dunnett"", ""simes""))"
"0","outputs <- data.frame()"
"0","res.list <- list()"
"0","for(i in 1:nrow(HRs)){"
"0","  hrS <- HRs[i,1]"
"0","  hrSc <- HRs[i,2]"
"0","  res <- getOC_par(ncore=nclust, seed = seed, nsim = nsim_per_cluster, n = nF, prop_S = pr, "
"0","                   duration = accrual_duration, targetEvents.S = targetEvents_S, "
"0","                   HR.Sc.threshold = HR.Sc.threshold, HR.S.threshold = HR.S.threshold,"
"0","                   HR.F.threshold = HR.F.threshold, hazard_S = log(2)/c(medS_con, medS_con/hrS), "
"0","                   hazard_Sc = log(2)/c(medSc_con, medSc_con/hrSc), dropout_S = c(0, 0), "
"0","                   dropout_Sc = c(0, 0), w = 1, ratio = 1, alpha = alpha)"
"0","  res.list[[i]] <- res"
"0","  # reject S or F. "
"0","  results[,1] <- sapply(res, function(x) mean(apply(x[,1:2], 1, any)))"
"0","  # reject S"
"0","  results[,2] <- sapply(res, function(x) mean(x[,1]))"
"0","  # reject F"
"0","  results[,3] <- sapply(res, function(x) mean(x[,2]))"
"0","  # selecting dual primary"
"0","  results[,4] <- sapply(res, function(x) mean(x[,3] & x[,4]))"
"0","  # selecting S primary"
"0","  results[,5] <- sapply(res, function(x) mean(x[,3] & !x[,4]))"
"0","  # selecting F primary"
"0","  results[,6] <- sapply(res, function(x) mean(!x[,3] & x[,4]))"
"0","  # sample size"
"0","  results[,7] <- sapply(res, function(x) mean(x[,5]))"
"0","  # Sc futility rate"
"0","  results[,8] <- sapply(res, function(x) mean(x[,6]))"
"0","  ddd <- as.data.frame(results) %>% "
"0","    mutate(designs = designs, multiplicity = multiplicity, .before = 1) %>% "
"0","    mutate(scenario = i, .before = 1) %>% "
"0","    mutate(hrS = hrS, hrSc = hrSc, .after = scenario)"
"0","  if(i==1){"
"0","    outputs <- ddd"
"0","  }else{"
"0","    outputs <- bind_rows(outputs, ddd)"
"0","  }"
"0","}"
"0","res.pr50 <- res.list"
"0","(power.pr50 <- outputs)"
